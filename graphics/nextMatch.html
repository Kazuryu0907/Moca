<!DOCTYPE html>
<html lang="jp">
    <head>
        <meta charset="UTF-8">
        <script src="https://cdn.tailwindcss.com"></script>
        <style type="text/tailwindcss">
            @layer utilities{
                .player-name{
                    @apply text-gray-100 font-bold text-[50px] mt-1 text-center;
                }
                .player-icon{
                    @apply w-[280px] h-[280px] object-cover object-top border rounded-2xl;
                }
                .w-team{
                    @apply w-[900px];
                }
            }
        </style>
    </head>
    <body class="bg-gray-700 ">
        <div class="relative w-full h-[200px] ">
            <div id="bo" class="absolute font-bold text-gray-100 text-[50px] text-center inset-0 top-[50px]">bo3</div>
            <div id="matchName" class="absolute font-bold text-gray-100 text-[100px] text-center inset-0 top-[100px]">Grand Final</div>
        </div>
        <div class="font-bold  text-gray-100 text-[100px] flex mt-[150px] mx-10">
            <div id="blueTeamName" class="grid place-items-center h-[150px] fit w-team text-center my-auto">地上戦隊アカレンジャイ∠(　˙-˙ )／</div>
            <div class="flex-auto"></div>
            <div id="orangeTeamName" class="grid place-items-center h-[150px] fit  w-team text-center my-auto">総プレイ40時間</div>
        </div>
        <div class="mt-[80px] mx-7">
            <div class="flex">
                <!-- 900px -->
                <div class="flex gap-[30px] ">
                    <div>
                        <img class="player-icon" src="assets/0.png" >
                        <div class="player-name">宮古ミヤ</div>
                    </div>
                    <div>
                        <img class="player-icon" src="assets/1.png" >
                        <div class="player-name">幽鬼シオン</div>
                    </div>
                    <div>
                        <img class="player-icon" src="assets/2.png" >
                        <div class="player-name">早波八雲</div>
                    </div>
                </div>
                <div class="flex-auto"></div>
                <div class="flex gap-[30px]">
                    <div>
                        <img class="player-icon" src="assets/3.png" >
                        <div class="player-name">鳴海小波音</div>
                    </div>
                    <div>
                        <img class="player-icon" src="assets/4.png" >
                        <div class="player-name">ちゃんひな</div>
                    </div>
                    <div>
                        <img class="player-icon" src="assets/5.png" >
                        <div class="player-name">石蕗なのは</div>
                    </div>
                </div>
            </div>
        </div>
        <script type="text/javascript">
            let webSocket = new WebSocket("ws://localhost:8001/nextMatch");
            webSocket.onmessage = function(message){
                const msg = JSON.parse(message.data);
                const {cmd,data} = msg;
                console.log(msg);
                if(cmd == "matchInfo"){
                    const blueTeamName = data.blue;
                    const orangeTeamName = data.orange;
                    const matchName = data.name;
                    const bo = data.bo;
                    const blueMembers = data.blueMembers;
                    const orangeMembers = data.orangeMembers;
                    document.getElementById("blueTeamName").textContent = blueTeamName;
                    document.getElementById("orangeTeamName").textContent = orangeTeamName;
                    document.getElementById("bo").textContent = bo;
                    document.getElementById("matchName").textContent = matchName;
                    fit();
                }
            }

            const fit = () => {
                const defaultTextSize = 150;
                const divHeight = 150;
                let resizeText = document.getElementsByClassName('fit');
                for (let i = 0; i < resizeText.length; i++) {
                    let textElm = resizeText[i];
                    //----------INIT---------
                    textElm.style.marginTop = "0px";
                    textElm.style.fontSize = `${defaultTextSize}px`;
                    // console.log(i,textElm.getBoundingClientRect().height,textElm.scrollHeight);
                    let size = defaultTextSize;
                    for(;textElm.scrollHeight > divHeight && size > 1;size--){
                        textElm.style.fontSize = size + "px";
                    }
                    const margin = (divHeight - textElm.scrollHeight)/2;
                    textElm.style.marginTop = `${margin}px`;
                }
            }
            window.onload = function(){fit()};
        </script>
    </body>
</html>