<!DOCTYPE html>
<html>
    <head>
        <title>Moca Matching Overlay</title>
        <script src="https://cdn.tailwindcss.com"></script>
    </head>
    <body class="bg-gray-500" style="background-image: url(1./matching.png);">
        


        <div class="flex">
            <div class="mt-5">

                <div class="mt-2 bg-gray-800 w-[350px] h-[50px] rounded-r-[0.2rem]">
                    <div class="ml-5 mr-2">
                        <div class="flex">
                            <div id="player_name0" class=" text-left text-[25px] text-gray-100 font-bold flex-auto">GB</div>
                            <div id="boost0" class="text-right text-[25px] text-gray-100 font-bold w-[50px] flex-initial">100</div>
                        </div>
                        <div class="w-auto bg-black h-2 rounded-[0.2rem]">
                            <div id="boost_bar0" class="bg-orange-500 h-2 rounded-[0.2rem]" style="width:45%"></div>
                        </div>
                    </div>
                </div>
                <div class="mt-2 bg-gray-800 w-[350px] h-[50px] rounded-r-[0.2rem]">
                    <div class="ml-5 mr-2">
                        <div class="flex">
                            <div id="player_name1" class="text-left text-[25px] text-gray-100 font-bold flex-auto">Kani</div>
                            <div id="boost1" class="text-right text-[25px] text-gray-100 font-bold w-[50px] flex-initial">100</div>
                        </div>
                        <div class="w-auto bg-black h-2 rounded-[0.2rem]">
                            <div id="boost_bar1" class="bg-orange-500 h-2 rounded-[0.2rem]" style="width:45%"></div>
                        </div>
                    </div>
                </div>
                <div class="mt-2 bg-gray-800 w-[350px] h-[50px] rounded-r-[0.2rem]">
                    <div class="ml-5 mr-2">
                        <div class="flex">
                            <div id="player_name2" class="text-left text-[25px] text-gray-100 font-bold flex-auto">Neko</div>
                            <div id="boost2" class=" text-right text-[25px] text-gray-100 font-bold w-[50px] flex-initial">100</div>
                        </div>
                        <div class="w-auto bg-black h-2 rounded-[0.2rem]">
                            <div id="boost_bar2" class="bg-orange-500 h-2 rounded-[0.2rem]" style="width:45%"></div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Dummy -->
            <div class="flex-auto"></div>
            <div class="mt-10 h-[70px] border  w-[1030px]">
                <!-- <div class="flex-auto"></div> -->
                <div class="flex w-[1030px]">
                    <div class="ml-auto w-[360px] h-[70px]">
                        <div id="blue_team_name" class="fit border border-red-300  font-bold text-gray-100 text-center text-[50px] mt-auto"><nobr>GENG</nobr></div>
                    </div>
                    <div class="w-[300px] h-[70px] border mt-0">
                        <div class="flex text-center">
                            <div id="point_blue" class="text-center border w-[80px] font-bold text-gray-100 text-[50px]">0</div>
                            <!-- Dummy -->
                            <div class="flex-auto"></div>
                            <div id="point_orange" class="text-center border w-[80px] font-bold text-gray-100 text-[50px]">1</div>
                        </div>
                    </div>
                    <div class="mr-auto w-[360px] h-[70px]">
                        <div id="orange_team_name" class="fit border font-bold text-gray-100 text-center text-[50px]">FAZE</div>
                    </div>
                </div>
                <!-- <div class="flex-auto"></div> -->
            </div>
            <!-- Dummy -->
            <div class="flex-auto"></div>
            <div class="mt-5 right-0">

                <div class="mt-2 bg-gray-800 w-[350px] h-[50px] rounded-l-[0.2rem]">
                    <div class="ml-2 mr-5">
                        <div class="flex">
                            <div id="boost3" class="text-left text-[25px] text-gray-100 font-bold w-[50px] flex-initial">100</div>
                            <div id="player_name3" class="text-right text-[25px] text-gray-100 font-bold flex-auto">GB</div>
                        </div>
                        <div class="w-auto bg-black h-2 rounded-[0.2rem]">
                            <div id="boost_bar3" class="bg-blue-500 h-2 rounded-[0.2rem] ml-auto" style="width:45%"></div>
                        </div>
                    </div>
                </div>
                <div class="mt-2 bg-gray-800 w-[350px] h-[50px] rounded-l-[0.2rem]">
                    <div class="ml-2 mr-5">
                        <div class="flex">
                            <div id="boost4" class="text-left text-[25px] text-gray-100 font-bold w-[50px] flex-initial">100</div>
                            <div id="player_name4" class=" text-right text-[25px] text-gray-100 font-bold flex-auto">Kani</div>
                        </div>
                        <div class="w-auto bg-black h-2 rounded-[0.2rem]">
                            <div id="boost_bar4" class="bg-blue-500 h-2 rounded-[0.2rem] ml-auto" style="width:45%"></div>
                        </div>
                    </div>
                </div>
                <div class="mt-2 bg-gray-800 w-[350px] h-[50px] rounded-l-[0.2rem]">
                    <div class="ml-2 mr-5">
                        <div class="flex">
                            <div id="boost5" class="text-left text-[25px] text-gray-100 font-bold w-[50px] flex-initial">100</div>
                            <div id="player_name5" class="text-right text-[25px] text-gray-100 font-bold flex-auto">Neko</div>
                        </div>
                        <div class="w-auto bg-black h-2 rounded-[0.2rem]">
                            <div id="boost_bar5" class="bg-blue-500 h-2 rounded-[0.2rem] ml-auto" style="width:45%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>





        player_name{n},boost{n},boost_bar{n}
        point_blue,point_orange





        <!-- <button onclick="feedout('#blue_1',-500);feedout('#blue_2',-500);feedout('#orange_1',500);feedout('#orange_2',500);">B</button> -->
        <!-- <button id="b">C</button> -->
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.0/gsap.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script>
            const fit = () => {
                const defaultTextSize = 50;
                const divHeight = 70;
                let resizeText = document.getElementsByClassName('fit');
                for (let i = 0; i < resizeText.length; i++) {
                    let textElm = resizeText[i];
                    //----------INIT---------
                    textElm.style.marginTop = "0px";
                    textElm.style.fontSize = `${defaultTextSize}px`;
                    // console.log(i,textElm.getBoundingClientRect().height,textElm.scrollHeight);
                    let size = defaultTextSize;
                    for(;textElm.scrollHeight > divHeight && size > 1;size--){
                        textElm.style.fontSize = size + "px";
                    }
                    const margin = (divHeight - textElm.scrollHeight)/2;
                    textElm.style.marginTop = `${margin}px`;
                }
            }
            const feedin = (tar,x) => {
                gsap.set(tar,{opacity:1});
                gsap.from(tar,{x:x,duration:0.8,opacity:0,ease:Circ.easeOut});
            }

            const feedout = (tar,x)=> {
                gsap.set(tar,{opacity:0});
                gsap.to(tar,{x:x,duration:0.8,opacity:1,ease:Circ.easeOut});
            };


            let webSocket;
            let playerTable = {};
            let idTable = {};
            let matchInfo = {};
            webSocket = new WebSocket("ws://localhost:8001/boost");

            webSocket.onmessage = function(message){
                
                const msg = JSON.parse(message.data);
                const cmd = msg["cmd"];
                const data = msg["data"];
                if(cmd != "boost")console.log(msg);
                if(cmd == "boost"){// Boost
                    // document.getElementById("boosts").style.visibility = "visible";
                    const {boost,index} = data;
                    document.getElementById("boost"+index).textContent = boost;
                    document.getElementById("boost_bar"+index).style.width = boost+"%";
                    // document.getElementById("boost_"+index).value = parseInt(boost);
                    // document.getElementById("boost_val_"+index).textContent = boost;
                }
                else if(cmd == "matchInfo"){
                    matchInfo = data;
                    const blueTeamName = data.blue;
                    const orangeTeamName = data.orange;
                    document.getElementById("blue_team_name").textContent = blueTeamName;
                    document.getElementById("orange_team_name").textContent = orangeTeamName;
                    fit();
                }
                else if(cmd == "playerTable"){// teamTable
                    const ids = data;
                    console.log(ids,idTable);
                    for(let i = 0;i<6;i++){
                        const id = ids[i];
                        document.getElementById("player_name"+i).textContent = idTable[id];
                    }
                }
                else if(cmd == "idTable"){
                    idTable = data;
                }
            }

        </script>
    </body>
</html>