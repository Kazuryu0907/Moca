<!DOCTYPE html>
<html>
    <head>
        <title>Moca Matching Overlay</title>
        <script src="https://cdn.tailwindcss.com"></script>
    </head>
    <body class="font-['DSEG7 Classic']" style="background-image: url(./matching.png);">
        
        <div class="flex mt-10 h-[70px] border border-red-600">
            <div class="flex-auto"></div>
            <div class="flex w-[1030px]  items-center">
                <div class="ml-auto w-[260px]">
                    <div class="font-bold text-gray-100 text-center text-[35px] mt-auto">GENG</div>
                </div>
                <div class="w-[300px] h-auto border border-red-500">
                    <div class="flex text-center">
                        <div class="ml-4 font-bold text-gray-100 text-[60px]">0</div>
                        <!-- Dummy -->
                        <div class="flex-auto"></div>
                        <div class="mr-4 font-bold text-gray-100 text-[60px]">1</div>
                    </div>
                </div>
                <div class="mr-auto w-[260px]">
                    <div class="font-bold text-gray-100 text-center text-[35px] mt-auto">FAZE</div>
                </div>
            </div>
            <div class="flex-auto"></div>
        </div>











        <div class="flex invisible">
            
            <div class="mt-5">

                <div class="mt-2 bg-gray-800 w-[350px] h-[50px] rounded-r-[0.2rem]">
                    <div class="ml-5 mr-2">
                        <div class="flex">
                            <div class=" text-left text-[25px] text-gray-100 font-bold flex-auto">GB</div>
                            <div class=" text-right text-[25px] text-gray-100 font-bold w-[50px] flex-initial">100</div>
                        </div>
                        <div class="w-auto bg-black h-2 rounded-[0.2rem]">
                            <div class="bg-slate-100 h-2 rounded-[0.2rem]" style="width:45%"></div>
                        </div>
                    </div>
                </div>
                <div class="mt-2 bg-gray-800 w-[350px] h-[50px] rounded-r-[0.2rem]">
                    <div class="ml-5 mr-2">
                        <div class="flex">
                            <div class=" text-left text-[25px] text-gray-100 font-bold flex-auto">Kani</div>
                            <div class=" text-right text-[25px] text-gray-100 font-bold w-[50px] flex-initial">100</div>
                        </div>
                        <div class="w-auto bg-black h-2 rounded-[0.2rem]">
                            <div class="bg-slate-100 h-2 rounded-[0.2rem]" style="width:45%"></div>
                        </div>
                    </div>
                </div>
                <div class="mt-2 bg-gray-800 w-[350px] h-[50px] rounded-r-[0.2rem]">
                    <div class="ml-5 mr-2">
                        <div class="flex">
                            <div class=" text-left text-[25px] text-gray-100 font-bold flex-auto">Neko</div>
                            <div class=" text-right text-[25px] text-gray-100 font-bold w-[50px] flex-initial">100</div>
                        </div>
                        <div class="w-auto bg-black h-2 rounded-[0.2rem]">
                            <div class="bg-slate-100 h-2 rounded-[0.2rem]" style="width:45%"></div>
                        </div>
                    </div>
                </div>
    
            </div>
            <!-- Dummy -->
            <div class="flex-auto"></div>
            <!-- left -->
            <div class="mt-5 right-0">

                <div class="mt-2 bg-gray-800 w-[350px] h-[50px] rounded-l-[0.2rem]">
                    <div class="ml-2 mr-5">
                        <div class="flex">
                            <div class=" text-left text-[25px] text-gray-100 font-bold w-[50px] flex-initial">100</div>
                            <div class=" text-right text-[25px] text-gray-100 font-bold flex-auto">GB</div>
                        </div>
                        <div class="w-auto bg-black h-2 rounded-[0.2rem]">
                            <div class="bg-slate-100 h-2 rounded-[0.2rem] ml-auto" style="width:45%"></div>
                        </div>
                    </div>
                </div>
                <div class="mt-2 bg-gray-800 w-[350px] h-[50px] rounded-l-[0.2rem]">
                    <div class="ml-2 mr-5">
                        <div class="flex">
                            <div class=" text-left text-[25px] text-gray-100 font-bold w-[50px] flex-initial">100</div>
                            <div class=" text-right text-[25px] text-gray-100 font-bold flex-auto">Kani</div>
                        </div>
                        <div class="w-auto bg-black h-2 rounded-[0.2rem]">
                            <div class="bg-slate-100 h-2 rounded-[0.2rem] ml-auto" style="width:45%"></div>
                        </div>
                    </div>
                </div>
                <div class="mt-2 bg-gray-800 w-[350px] h-[50px] rounded-l-[0.2rem]">
                    <div class="ml-2 mr-5">
                        <div class="flex">
                            <div class=" text-left text-[25px] text-gray-100 font-bold w-[50px] flex-initial">100</div>
                            <div class=" text-right text-[25px] text-gray-100 font-bold flex-auto">Neko</div>
                        </div>
                        <div class="w-auto bg-black h-2 rounded-[0.2rem]">
                            <div class="bg-slate-100 h-2 rounded-[0.2rem] ml-auto" style="width:45%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- <button onclick="feedout('#blue_1',-500);feedout('#blue_2',-500);feedout('#orange_1',500);feedout('#orange_2',500);">B</button> -->
        <!-- <button id="b">C</button> -->
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.7.0/gsap.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script>
            let preFocus = "";
            $(function(){
                for(let i = 0;i<4;i++){
                const name = nodecg.Replicant(`name_${i}`).value;
                $(`#boost_name_${i}`).text(name);
            }
            })

            const feedin = (tar,x) => {
                gsap.set(tar,{opacity:1});
                gsap.from(tar,{x:x,duration:0.8,opacity:0,ease:Circ.easeOut});
            }

            const feedout = (tar,x)=> {
                gsap.set(tar,{opacity:0});
                gsap.to(tar,{x:x,duration:0.8,opacity:1,ease:Circ.easeOut});
            };

            function adjustFontSize(el){
                const textElem = document.getElementById(el);
                let font_size = 80;
                textElem.style.fontSize = font_size + "px";
                for(;textElem.scrollHeight > textElem.getBoundingClientRect().height && font_size > 1;font_size--){
                    console.log(textElem.scrollHeight,textElem.getBoundingClientRect().height,font_size,textElem.scrollHeight > textElem.getBoundingClientRect().height);
                    textElem.style.fontSize = font_size + "px";
                }
                textElem.style.fontSize = font_size + "px";
            };

            // adjustFontSize("boost_name_0");adjustFontSize("boost_name_1");
            nodecg.Replicant("blueName").on("change",newValue => {
                $("#blue_team_name").text(newValue);
            })
            nodecg.Replicant("orangeName").on("change",newValue => {
                $("#orange_team_name").text(newValue);
            })

            nodecg.Replicant("countblueP").on("change",newValue => {
                let c = parseInt(newValue);
                for(let i=0;i<c;i++){
                    $(`#set_b_${i+1}`).show();
                }
                for(let i=0;i<2-c;i++){
                    $(`#set_b_${2-i}`).hide();
                }
            })
            nodecg.Replicant("countorangeP").on("change",newValue => {
                let c = parseInt(newValue);
                for(let i=0;i<c;i++){
                    $(`#set_o_${i+1}`).show();
                }
                for(let i=0;i<2-c;i++){
                    $(`#set_o_${2-i}`).hide();
                }
            })

            for(let i = 0;i<6;i++){
                nodecg.Replicant(`boost_${i}`).on("change",newValue => {
                    $(`#boost_${i}`).val(newValue);
                    $(`#boost_val_${i}`).text(newValue);
                });
            }
            for(let i = 0;i<6;i++){
                nodecg.Replicant(`name_${i}`).on("change",newValue => {
                    $(`#boost_name_${i}`).text(newValue);
                    adjustFontSize(`boost_name_${i}`);
                });
            }
            nodecg.listenFor("scored",()=>{
                console.log("scored");
                $("#goal_v").show();
                const v = $("#goal_v").get(0);
                v.load();
                v.play();
            })
            document.getElementById("goal_v").addEventListener("ended",function(){
                console.log("goal_end");
                $("#goal_v").hide();
                // feedin('#blue_1',-100);feedin('#blue_2',-100);feedin('#blue_3',-100);feedin('#orange_1',100);feedin('#orange_2',100);feedin('#orange_3',100);
            })

            nodecg.listenFor("endStats",() => {feedout('#blue_1',-500);feedout('#blue_2',-500);feedout('#blue_3',-500);feedout('#orange_1',500);feedout('#orange_2',500);feedout('#orange_3',500);});

            nodecg.Replicant("focus").on("change",newValue => {
                $(`#img_${preFocus}`).removeClass("focusing");
                $(`#img_${newValue}`).addClass("focusing");
                preFocus = newValue;
            })
            nodecg.listenFor("start",() => {
                feedin('#blue_1',-100);feedin('#blue_2',-100);feedin('#blue_3',-100);feedin('#orange_1',100);feedin('#orange_2',100);feedin('#orange_3',100);
            })
            nodecg.listenFor("icons_info",(data,ack) => {
                const [type,index] = data;
                if(type == "demo"){
                    console.log("demo");
                    let count =parseInt($(`#bump_count_${index}`).text());
                    $(`#bump_count_${index}`).text(count+1);
                }
            })

        </script>
    </body>
</html>